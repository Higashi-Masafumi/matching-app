{
  "openapi": "3.0.3",
  "info": {
    "title": "Matching App API",
    "version": "0.1.0",
    "description": "API specification for the university matching platform."
  },
  "servers": [
    {
      "url": "https://api.example.com"
    }
  ],
  "components": {
    "schemas": {
      "University": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "minLength": 1,
            "example": "uni_1234"
          },
          "name": {
            "type": "string",
            "minLength": 1,
            "example": "Example University"
          },
          "location": {
            "type": "string",
            "minLength": 1,
            "example": "Tokyo, JP"
          },
          "programs": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            },
            "minItems": 1,
            "example": [
              "Computer Science",
              "Economics"
            ]
          },
          "website": {
            "type": "string",
            "format": "uri",
            "example": "https://www.exampleuniversity.jp"
          }
        },
        "required": [
          "id",
          "name",
          "location",
          "programs"
        ]
      },
      "UniversityCatalogResponse": {
        "type": "object",
        "properties": {
          "total": {
            "type": "integer",
            "minimum": 0,
            "example": 128
          },
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/University"
            }
          }
        },
        "required": [
          "total",
          "results"
        ]
      },
      "MatchCandidate": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "minLength": 1,
            "example": "candidate_987"
          },
          "name": {
            "type": "string",
            "minLength": 1,
            "example": "Hiro Tanaka"
          },
          "universityId": {
            "type": "string",
            "minLength": 1,
            "example": "uni_1234"
          },
          "matchScore": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Compatibility between 0 and 1",
            "example": 0.82
          },
          "sharedInterests": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            },
            "example": [
              "Machine Learning",
              "Language Exchange"
            ]
          },
          "introduction": {
            "type": "string",
            "example": "Interested in study abroad research projects."
          }
        },
        "required": [
          "id",
          "name",
          "universityId",
          "matchScore",
          "sharedInterests"
        ]
      },
      "MatchCandidatesResponse": {
        "type": "object",
        "properties": {
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MatchCandidate"
            }
          },
          "nextOffset": {
            "type": "integer",
            "nullable": true,
            "example": 10
          }
        },
        "required": [
          "results",
          "nextOffset"
        ]
      },
      "Profile": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "minLength": 1,
            "example": "user_456"
          },
          "name": {
            "type": "string",
            "minLength": 1,
            "example": "Mika Sato"
          },
          "universityId": {
            "type": "string",
            "minLength": 1,
            "example": "uni_1234"
          },
          "majors": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            },
            "example": [
              "Economics",
              "Data Science"
            ]
          },
          "interests": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            },
            "example": [
              "AI ethics",
              "Music"
            ]
          },
          "languages": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            },
            "example": [
              "ja",
              "en"
            ]
          },
          "bio": {
            "type": "string",
            "example": "Looking for research exchange opportunities."
          },
          "preferredLocations": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            },
            "example": [
              "Tokyo",
              "Osaka"
            ]
          }
        },
        "required": [
          "id",
          "name",
          "universityId",
          "majors",
          "interests",
          "languages",
          "preferredLocations"
        ]
      },
      "ProfileUpdateRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1
          },
          "majors": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            }
          },
          "interests": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            }
          },
          "languages": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            }
          },
          "bio": {
            "type": "string"
          },
          "preferredLocations": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            }
          }
        },
        "description": "Editable fields for the user profile"
      }
    },
    "parameters": {}
  },
  "security": [
    {
      "UniversityEmailOtp": []
    },
    {
      "StudentIdUpload": []
    }
  ],
  "paths": {
    "/catalog/universities": {
      "get": {
        "description": "Retrieve universities available for matching.",
        "summary": "List university catalog",
        "tags": [
          "Catalog"
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "description": "Free text search"
            },
            "required": false,
            "description": "Free text search",
            "name": "search",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Filter by program name"
            },
            "required": false,
            "description": "Filter by program name",
            "name": "program",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "description": "Filter by country code"
            },
            "required": false,
            "description": "Filter by country code",
            "name": "country",
            "in": "query"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 50,
              "default": 20,
              "description": "Maximum results to return",
              "example": 20
            },
            "required": false,
            "description": "Maximum results to return",
            "name": "limit",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Catalog entries matching the filters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UniversityCatalogResponse"
                }
              }
            }
          }
        }
      }
    },
    "/matches/candidates": {
      "get": {
        "summary": "Fetch recommended match candidates for the authenticated user",
        "description": "Returns a ranked list of candidates using the current profile context.",
        "tags": [
          "Matches"
        ],
        "security": [
          {
            "UniversityEmailOtp": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 25,
              "default": 10,
              "description": "Number of candidates to retrieve",
              "example": 10
            },
            "required": false,
            "description": "Number of candidates to retrieve",
            "name": "limit",
            "in": "query"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 0,
              "description": "Pagination offset",
              "example": 0
            },
            "required": false,
            "description": "Pagination offset",
            "name": "offset",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Candidate matches returned successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MatchCandidatesResponse"
                }
              }
            }
          },
          "401": {
            "description": "Missing or invalid email OTP authentication"
          }
        }
      }
    },
    "/profile": {
      "put": {
        "summary": "Update the current user profile",
        "description": "Persists profile fields to improve match quality.",
        "tags": [
          "Profile"
        ],
        "security": [
          {
            "StudentIdUpload": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProfileUpdateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated profile data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Profile"
                }
              }
            }
          },
          "401": {
            "description": "Student ID verification token is missing or invalid"
          }
        }
      }
    },
    "/openapi": {
      "get": {
        "summary": "OpenAPI document redirect",
        "description": "Redirects to the OpenAPI JSON document.",
        "responses": {
          "302": {
            "description": "Redirect to the OpenAPI document"
          }
        }
      }
    }
  }
}